const modals = document.querySelectorAll('[data-modal]')
const modalWindow =  document.getElementById('modal')
const body = document.body

modals.forEach(modal => {
    modal.addEventListener('click', function(elem){
        let target = elem.currentTarget
        let modalId = target.getAttribute('data-modal')
        let modalObj = document.getElementById(modalId)

        let modalContent = modalWindow.querySelectorAll('.modal__content')
        modalContent.forEach(modal =>{
            modal.addEventListener('click', event => {
                event.stopPropagation();
            })
        })

        modalWindow.style.display = 'block'
        modalObj.style.display = 'block'
        body.classList.add('no-scroll')
    })
})

const close_btns = document.querySelectorAll('.close_modal')

close_btns.forEach(close_btn =>{
    close_btn.addEventListener('click', elem =>{
        close_modal()
    })
})

modalWindow.addEventListener('click', elem =>{
    close_modal()
})

let modal__story__img = document.getElementById('modal__story__img') 
modals.forEach(modal =>{
    let modal_attr = modal.getAttribute('data-modal')
    if (modal_attr == 'story'){
        modal.addEventListener('click', elem =>{
            let target = elem.currentTarget
            let preview = target.querySelector('.stories__preview')
            let preview_src = preview.getAttribute('src')
            let story_img = document.createElement("IMG")

            story_img.src = preview_src
            modal__story__img.appendChild(story_img)
        })
        
    }
})

const modal__content = document.querySelectorAll('.modal__content')
function close_modal(){
    modal__content.forEach(elem =>{
        elem.removeAttribute('style')
    })
    modalWindow.removeAttribute('style')
    body.classList.remove('no-scroll')
    modal__story__img.removeChild(modal__story__img.firstChild)
}

const burger = document.querySelector('.burger')
burger.addEventListener('click', e =>{
    body.classList.toggle('sidebar--active')
})


const textInputs = document.querySelectorAll('[data-autoresize]')
textInputs.forEach(input =>{
    let inputH = input.offsetHeight
    input.addEventListener('input', e =>{
        let current = e.target

        current.style.height = inputH
        current.style.height = current.scrollHeight + 'px'
    })
})